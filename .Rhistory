View(results)
View(results$el1)
min(results$el1)
max(results$el1)
source("~/simulambient/R/simulambient.R")
results <- simulambient(dataset = fullgeneDF_10000[,1:500], contamination = ambient[,1:10000], cellTypes = cellTypes[1:500], sex = sex[1:500])
View(results)
colSums1 <- colSums(results$ground_truth)
colSums1 <- colSums(results$1)
colSums2 <- colSums(results$`1`)
ggg <- colSums2 - colSums1
View(as.matrix(ggg))
results2 <- simulambient(dataset = fullgeneDF_10000[,1:500], contamination = ambient[,1:10000], cellTypes = cellTypes[1:500], sex = sex[1:500], contamination_levels = 2)
colSums1 <- colSums(results2$ground_truth)
colSums2 <- colSums(results2$`1`)
colSums2 <- colSums(results2$`2`)
ggg2 <- colSums2 - colSums1
View(as.matrix(ggg2))
View(as.matrix(fullgeneDF_10000[,1:500]))
View(as.matrix(ambient[,1:20]))
print(head(sex))
print(head(cellTypes))
print(geneMeans)
View(geneMeans)
source("~/simulambient/R/simulambient.R")
results <- simulambient(dataset = fullgeneDF_10000[,1:500], contamination = ambient[,1:10000], cellTypes = cellTypes[1:500], sex = sex[1:500], contamination_levels = 1)
View(results$geneMeans)
source("~/simulambient/R/simulambient.R")
results <- simulambient(dataset = fullgeneDF_10000[,1:500], contamination = ambient[,1:10000], cellTypes = cellTypes[1:500], sex = sex[1:500], contamination_levels = 1)
View(results)
source("~/simulambient/R/simulambient.R")
results <- simulambient(dataset = fullgeneDF_10000[,1:500], contamination = ambient[,1:10000], cellTypes = cellTypes[1:500], sex = sex[1:500], contamination_levels = 1)
View(as.matrix(results[,1:40]))
source("~/simulambient/R/simulambient.R")
ggg3 <- data.frame(ggg, ggg2)
View(ggg3)
ggg3 <- data.frame(ggg3[,2] / ggg3[,1])
mean(ggg3)
mean(ggg3[,1])
ggg3 <- data.frame(ggg, ggg2)
?mapply
devtools::document()
rm(list = c("check_args", "decontaminate", "estimate_params"))
devtools::document()
rm(list = c("get_umis", "simulambient", "simulate_counts"))
devtools::document()
load("~/Boehnke-Scott/Data/FullGene/STARsolo/fullgeneDF_sparse.RData")
sce <- SingleCellExperiment(list(counts=counts))
library(SingleCellExperiment)
sce <- SingleCellExperiment(list(counts=counts))
sce <- SingleCellExperiment(list(counts=ambient))
sce <- SingleCellExperiment(list(counts=fullgeneDF[,1:32135]))
names(fullgeneDF)
names(fullgeneDF_10000)
head(colnames(fullgeneDF_10000))
names(counts)
head(colnames(fullgeneDF[,1:32135]))
colnames(counts499) <- as.vector(unlist(colnames(counts499)))
counts499 <- fullgeneDF[,1:32135]
colnames(counts499) <- as.vector(unlist(colnames(counts499)))
results <- simulambient(counts499[,1:500], contamination_levels = c(1, 50), contamination = ambient[,1:200], cellTypes = nucleiDF$cellTypes[1:500], sex = nucleiDF$sex[1:500])
source("~/simulambient/R/simulambient.R")
source("~/simulambient/R/get_umis.R")
source("~/simulambient/R/estimate_params.R")
source("~/simulambient/R/simulate_counts.R")
source("~/simulambient/R/decontaminate.R")
source("~/simulambient/R/check_args.R")
results <- simulambient(counts499[,1:500], contamination_levels = c(1, 50), contamination = ambient[,1:200], cellTypes = nucleiDF$cellTypes[1:500], sex = nucleiDF$sex[1:500])
colnames(ambient)
colnames(ambient) <- as.character(1:ncol(ambient))
results <- simulambient(counts499[,1:500], contamination_levels = c(1, 50), contamination = ambient[,1:200], cellTypes = nucleiDF$cellTypes[1:500], sex = nucleiDF$sex[1:500])
head(colnames(counts499))
head(rownames(counts499))
head(rownames(ambient))
rownames(counts499) <- rownames(ambient)
results <- simulambient(counts499[,1:500], contamination_levels = c(1, 50), contamination = ambient[,1:200], cellTypes = nucleiDF$cellTypes[1:500], sex = nucleiDF$sex[1:500])
source("~/simulambient/R/simulambient.R")
results <- simulambient(counts499[,1:500], contamination_levels = c(1, 50), contamination = ambient[,1:200], cellTypes = nucleiDF$cellTypes[1:500], sex = nucleiDF$sex[1:500])
View(results)
abc <- data.frame(colSums(results$`1`) - colSums(results$ground_truth), colSums(results$`50`) - colSums(results$`1`))
View(abc)
936*50
abc <- data.frame(abc, abc[,2] / abc[,1])
mean(abc[,3])
source("~/simulambient/R/simulambient.R")
results <- simulambient(counts499[,1:500], contamination_levels = c(1, 50), contamination = ambient[,1:200], cellTypes = nucleiDF$cellTypes[1:500], sex = nucleiDF$sex[1:500])
abc <- data.frame(colSums(results$`1`) - colSums(results$ground_truth), colSums(results$`50`) - colSums(results$`1`))
abc <- data.frame(abc, abc[,2] / abc[,1])
mean(abc[,3])
View(abc)
results <- simulambient(counts499[,1:500], contamination_levels = c(1, 2), contamination = ambient[,1:200], cellTypes = nucleiDF$cellTypes[1:500], sex = nucleiDF$sex[1:500])
abc <- data.frame(colSums(results$`1`) - colSums(results$ground_truth), colSums(results$`50`) - colSums(results$`1`))
abc <- data.frame(colSums(results$`1`) - colSums(results$ground_truth), colSums(results$`2`) - colSums(results$`1`))
mean(abc[,3])
abc <- data.frame(abc, abc[,2] / abc[,1])
mean(abc[,3])
source("~/simulambient/R/simulambient.R")
results <- simulambient(counts499[,1:500], contamination_levels = c(1, 2), contamination = ambient[,1:200], cellTypes = nucleiDF$cellTypes[1:500], sex = nucleiDF$sex[1:500])
abc <- data.frame(colSums(results$`1`) - colSums(results$ground_truth), colSums(results$`2`) - colSums(results$`1`))
abc <- data.frame(abc, abc[,2] / abc[,1])
mean(abc[,3])
View(abc)
source("~/simulambient/R/simulambient.R")
results <- simulambient(counts499[,1:500], contamination_levels = c(1, 2), contamination = ambient[,1:200], cellTypes = nucleiDF$cellTypes[1:500], sex = nucleiDF$sex[1:500])
abc <- data.frame(colSums(results$`1`) - colSums(results$ground_truth), colSums(results$`2`) - colSums(results$`1`))
abc <- data.frame(abc, abc[,2] / abc[,1])
mean(abc[,3])
View(abc)
colSums(results$ground_truth)
colSums(results$ground_truth$`1`)
colSums(results$`1`)
source("~/simulambient/R/simulambient.R")
results <- simulambient(counts499[,1:500], contamination_levels = c(1, 2), contamination = ambient[,1:200], cellTypes = nucleiDF$cellTypes[1:500], sex = nucleiDF$sex[1:500])
View(results)
View(data.frame(results$geneMeans, results$geneSDs))
source("~/simulambient/R/simulambient.R")
results <- simulambient(counts499[,1:500], contamination_levels = c(1, 2), contamination = ambient[,1:200], cellTypes = nucleiDF$cellTypes[1:500], sex = nucleiDF$sex[1:500])
abc <- data.frame(colSums(results$`1`) - colSums(results$ground_truth), colSums(results$`2`) - colSums(results$`1`))
abc <- data.frame(abc, abc[,2] / abc[,1])
mean(abc[,3])
View(abc)
source("~/simulambient/R/simulambient.R")
results <- simulambient(counts499[,1:500], contamination_levels = c(1, 2), contamination = ambient[,1:200], cellTypes = nucleiDF$cellTypes[1:500], sex = nucleiDF$sex[1:500])
View(results)
source("~/simulambient/R/simulambient.R")
results <- simulambient(counts499[,1:500], contamination_levels = c(1, 2), contamination = ambient[,1:200], cellTypes = nucleiDF$cellTypes[1:500], sex = nucleiDF$sex[1:500])
View(results)
head(colSums(results))
dim(results)
View(as.matrix(results))
source("~/simulambient/R/simulambient.R")
source("~/simulambient/R/simulambient.R")
results <- simulambient(counts499[,1:500], contamination_levels = c(1, 2), contamination = ambient[,1:200], cellTypes = nucleiDF$cellTypes[1:500], sex = nucleiDF$sex[1:500])
abc <- data.frame(colSums(results$`1`) - colSums(results$ground_truth), colSums(results$`2`) - colSums(results$`1`))
abc <- data.frame(abc, abc[,2] / abc[,1])
mean(abc[,3])
View(abc)
mean(abc[-498,3])
anyNA(results$ground_truth)
anyNA(results$`1`)
anyNA(results$`2`)
ncol(ambient)
results <- simulambient(counts499, contamination_levels = c(1, 2, 5, 10), contamination = ambient[,1:60000], cellTypes = nucleiDF$cellTypes[1:32135], sex = nucleiDF$sex[1:32135])
gc()
abc <- data.frame(colSums(results$`1`) - colSums(results$ground_truth), colSums(results$`2`) - colSums(results$ground_truth), colSums(results$`5`) - colSums(results$ground_truth), colSums(results$`10`) - colSums(results$ground_truth))
View(abc)
mean(abc[,2] / abc[,1])
which(is.nan(abc[,1]))
which(is.nan(abc[,2]))
which(abc[,1] == 0)
mean(abc[-which(abc[,1] == 0),2] / abc[-which(abc[,1] == 0),1])
mean(abc[-which(abc[,3] == 0),2] / abc[-which(abc[,1] == 0),1])
mean(abc[-which(abc[,4] == 0),2] / abc[-which(abc[,1] == 0),1])
abc <- data.frame(abc, abc[,2] / abc[,1], abc[,3] / abc[,1])
mean(abc[-which(abc[,1] == 0),2] / abc[-which(abc[,1] == 0),1])
mean(abc[-which(abc[,1] == 0),3] / abc[-which(abc[,1] == 0),1])
mean(abc[-which(abc[,1] == 0),4] / abc[-which(abc[,1] == 0),1])
library(Seurat)
save(counts499, file = "~/simulambient/Data/counts499.RData")
cellTypes499 <- = nucleiDF$cellTypes[1:32135]
cellTypes499 <- nucleiDF$cellTypes[1:32135]
save(cellTypes499, file = "~/simulambient/Data/cellTypes499.RData")
sex499 <- = nucleiDF$sex[1:32135]
sex499 <- nucleiDF$sex[1:32135]
save(sex499, file = "~/simulambient/Data/sex499.RData")
save(results, file = "~/simulated/Data/preliminary_results.RData"
)
save(results, file = "~/simulambient/Data/preliminary_results.RData")
devtools::document()
source("~/simulambient/R/check_args.R")
source("~/simulambient/R/decontaminate.R")
source("~/simulambient/R/decontaminate.R")
source("~/simulambient/R/estimate_ambient_params.R")
source("~/simulambient/R/estimate_params.R")
source("~/simulambient/R/simulambient.R")
source("~/simulambient/R/simulate_contamination.R")
source("~/simulambient/R/simulate_counts.R")
load("~/simulambient/Data/counts499.RData")
load("~/simulambient/Data/cellTypes499.RData")
load("~/simulambient/Data/sex499.RData")
load("~/simulambient/Data/ambient.RData")
sex499DF <- data.frame(sex499)
View(sex499DF)
negBinTrial <- simulambient(counts = counts499, contamination_levels = c(0.5,1,1.5,2,5), contamination = ambient, metadata = sex499DF, cellTypes = cellTypes499)
negBinTrial <- simulambient(dataset = counts499, contamination_levels = c(0.5,1,1.5,2,5), contamination = ambient, metadata = sex499DF, cellTypes = cellTypes499)
library(Matrix)
library(stats)
library(sparseMatrixStats)
library(celda)
source("~/simulambient/R/estimate_ambient_params.R")
source("~/simulambient/R/estimate_params.R")
negBinTrial <- simulambient(dataset = counts499, contamination_levels = c(0.5,1,1.5,2,5), contamination = ambient, metadata = sex499DF, cellTypes = cellTypes499)
negBinTrial <- simulambient(dataset = counts499, contamination_levels = c(1,2,5), contamination = ambient, metadata = sex499DF, cellTypes = cellTypes499)
save(negBinTrial, file = "~/simulambient/Data/negBinTrial_Dec13.RData")
source("~/simulambient/R/check_args.R")
source("~/simulambient/R/decontaminate.R")
source("~/simulambient/R/estimate_ambient_params.R")
source("~/simulambient/R/estimate_params.R")
source("~/simulambient/R/simulambient.R")
source("~/simulambient/R/simulate_contamination.R")
source("~/simulambient/R/simulate_counts.R")
set.seed(2022)
set.seed("2022")
load("~/simulambient/Data/counts499.RData")
load("~/simulambient/Data/ambient.RData")
load("~/simulambient/Data/sex499.RData")
load("~/simulambient/Data/cellTypes499.RData")
sex499DF <- data.frame(sex499)
load("~/simulambient/Data/negBinTrial_Dec13.RData")
library(Seurat)
pilot1seurat5099 <- CreateSeuratObject(negBinTrial$`1`)
pilot1seurat5099 <- NormalizeData(pilot1seurat5099)
pilot1seurat5099 <- FindVariableFeatures(pilot1seurat5099, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(pilot1seurat5099)
pilot1seurat5099 <- ScaleData(pilot1seurat5099, features = all.genes)
pilot1seurat5099 <- RunPCA(pilot1seurat5099, features = VariableFeatures(object = pilot1seurat5099))
ElbowPlot(pilot1seurat5099)
pilot1seurat5099 <- FindNeighbors(pilot1seurat5099, dims = 1:10)
pilot1seurat5099 <- FindClusters(pilot1seurat5099, resolution = 0.5)
pilot1seurat5099 <- RunUMAP(pilot1seurat5099, dims = 1:10)
df <- data.frame(pilot1seurat5099@reductions$umap@cell.embeddings, cellTypes499)
library(ggplot2)
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point()
pilot1seurat5099 <- CreateSeuratObject(negBinTrial$ground_truth)
pilot1seurat5099 <- NormalizeData(pilot1seurat5099)
pilot1seurat5099 <- FindVariableFeatures(pilot1seurat5099, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(pilot1seurat5099)
pilot1seurat5099 <- ScaleData(pilot1seurat5099, features = all.genes)
pilot1seurat5099 <- RunPCA(pilot1seurat5099, features = VariableFeatures(object = pilot1seurat5099))
ElbowPlot(pilot1seurat5099)
pilot1seurat5099 <- FindNeighbors(pilot1seurat5099, dims = 1:10)
pilot1seurat5099 <- FindClusters(pilot1seurat5099, resolution = 0.5)
pilot1seurat5099 <- RunUMAP(pilot1seurat5099, dims = 1:10)
df <- data.frame(pilot1seurat5099@reductions$umap@cell.embeddings, cellTypes499)
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point()
rm(df, negBinTrial, pilot1seurat5099, all.genes)
gc()
negBinTrial2 <- simulambient(dataset = counts499, contamination_levels = c(1,2,5), contamination = ambient[,1:60000], metadata = sex499DF, cellTypes = cellTypes499, seed = 2022)
library(Matrix)
library(sparseMatrixStats)
library(celda)
negBinTrial2 <- simulambient(dataset = counts499, contamination_levels = c(1,2,5), contamination = ambient[,1:60000], metadata = sex499DF, cellTypes = cellTypes499, seed = 2022)
save(negBinTrial2, file = "~/simulambient/Data/negBinTrial_Dec14.RData")
pilot1seurat5099 <- CreateSeuratObject(negBinTrial2$ground_truth)
pilot1seurat5099 <- NormalizeData(pilot1seurat5099)
pilot1seurat5099 <- FindVariableFeatures(pilot1seurat5099, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(pilot1seurat5099)
pilot1seurat5099 <- ScaleData(pilot1seurat5099, features = all.genes)
pilot1seurat5099 <- RunPCA(pilot1seurat5099, features = VariableFeatures(object = pilot1seurat5099))
pilot1seurat5099 <- FindNeighbors(pilot1seurat5099, dims = 1:10)
pilot1seurat5099 <- FindClusters(pilot1seurat5099, resolution = 0.5)
pilot1seurat5099 <- RunUMAP(pilot1seurat5099, dims = 1:10)
df <- data.frame(pilot1seurat5099@reductions$umap, cellTypes499)
df <- data.frame(pilot1seurat5099@reductions$umap@cell.embeddings, cellTypes499)
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point()
rm(df, negBinTrial2, pilot1seurat5099, all.genes)
gc()
negBinTrial3 <- simulambient(dataset = counts499, contamination_levels = c(1,2,5), contamination = ambient[,1:60000], metadata = sex499DF, cellTypes = cellTypes499, seed = 12)
save(negBinTrial3, file = "~/simulambient/Data/negBinTrial_Dec14_2.RData")
gc()
load("~/simulambient/Data/counts499.RData")
library(Seurat)
library(ggplot2)
counts499_seurat <- CreateSeuratObject(counts499)
counts499_seurat <- NormalizeData(counts499_seurat)
counts499_seurat <- FindVariableFeatures(counts499_seurat, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(counts499_seurat)
counts499_seurat <- ScaleData(counts499_seurat, features = all.genes)
counts499_seurat <- RunPCA(counts499_seurat, features = VariableFeatures(object = counts499_seurat))
counts499_seurat <- FindNeighbors(counts499_seurat, dims = 1:10)
counts499_seurat <- FindClusters(counts499_seurat, resolution = 0.5)
counts499_seurat <- RunUMAP(counts499_seurat, dims = 1:10)
load("~/simulambient/Data/cellTypes499.RData")
df <- data.frame(counts499_seurat@reductions$umap, cellTypes499)
df <- data.frame(counts499_seurat@reductions$umap@cell.embeddings, cellTypes499)
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), legend.position = "none")
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), legend.position = "none")
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18)) + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "gray75", "T_Cell" = "snow4", "Adipocyte" = "black"))
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18)) + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "gray75", "T_Cell" = "gray33", "Adipocyte" = "black"))
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18)) + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"))
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), legend.position = "none") + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black")) + ggtitle("Real Data: 1x Contamination")
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), legend.position = "none", plot.title = element_text(hjust = 0.5), plot.title = element_text(face = "bold")) + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black")) + ggtitle("Real Data: 1x Contamination")
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), legend.position = "none", plot.title = element_text(hjust = 0.5, face = "bold")) + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black")) + ggtitle("Real Data: 1x Contamination")
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), legend.position = "none", plot.title = element_text(hjust = 0.5, face = "bold", size = 36)) + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black")) + ggtitle("Real Data: 1x Contamination")
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), legend.position = "none", plot.title = element_text(hjust = 0.5, face = "bold", size = 24)) + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black")) + ggtitle("Real Data: 1x Contamination")
save(df, file = "~/simulambient/Data/real_data_predecontx.RData")
source("~/simulambient/R/simulate_contamination.R")
source("~/simulambient/R/simulate_counts.R")
source("~/simulambient/R/simulambient.R")
source("~/simulambient/R/estimate_ambient_params.R")
source("~/simulambient/R/estimate_params.R")
source("~/simulambient/R/check_args.R")
source("~/simulambient/R/decontaminate.R")
load("~/simulambient/Data/ambient.RData")
dd <- decontaminate(counts499, contamination = ambient[,1:60000], cellTypes = cellTypes499)
real_postDX_seurat <- CreateSeuratObject(dd)
real_postDX_seurat <- NormalizeData(real_postDX_seurat)
real_postDX_seurat <- FindVariableFeatures(real_postDX_seurat, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(real_postDX_seurat)
real_postDX_seurat <- ScaleData(real_postDX_seurat, features = all.genes)
real_postDX_seurat <- RunPCA(real_postDX_seurat, features = VariableFeatures(object = real_postDX_seurat))
real_postDX_seurat <- FindNeighbors(real_postDX_seurat, dims = 1:10)
real_postDX_seurat <- FindClusters(real_postDX_seurat, resolution = 0.5)
real_postDX_seurat <- RunUMAP(real_postDX_seurat, dims = 1:10)
df <- data.frame(real_postDX_seurat@reductions$umap, cellTypes499)
df <- data.frame(real_postDX_seurat@reductions$umap@cell.embeddings, cellTypes499)
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), legend.position = "none", plot.title = element_text(hjust = 0.5, face = "bold", size = 24)) + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black")) + ggtitle("Real Data: 0x Contamination")
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24)) + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black")) + ggtitle("Real Data: 0x Contamination")
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24)) + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Real Data: 0x Contamination") + + guides(colour = guide_legend(override.aes = list(size=7)))
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24)) + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Real Data: 0x Contamination") + guides(colour = guide_legend(override.aes = list(size=7)))
save(df, file = "~/simulambient/real_data_postdecontx.RData")
rm(counts499_seurat, real_postDX_seurat)
load("~/simulambient/Data/negBinTrial.RData")
my_seurat <- CreateSeuratObject(attempt2$ground_truth)
my_seurat <- NormalizeData(my_seurat)
my_seurat <- FindVariableFeatures(my_seurat, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(my_seurat)
my_seurat <- ScaleData(my_seurat, features = all.genes)
my_seurat <- RunPCA(my_seurat, features = VariableFeatures(object = my_seurat))
my_seurat <- FindNeighbors(my_seurat, dims = 1:10)
my_seurat <- FindClusters(my_seurat, resolution = 0.5)
my_seurat <- RunUMAP(my_seurat, dims = 1:10)
df <- data.frame(my_seurat@reductions$umap@cell.embeddings, cellTypes499)
save(df, file = "~/simulambient/seed615_groundtruth.RData")
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24), legend.position = "none") + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Simulated Data: 0x Contamination")
load("~/simulambient/Data/negBinTrial_Dec13.RData")
my_seurat <- CreateSeuratObject(negBinTrial$ground_truth)
my_seurat <- NormalizeData(my_seurat)
my_seurat <- FindVariableFeatures(my_seurat, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(my_seurat)
my_seurat <- ScaleData(my_seurat, features = all.genes)
my_seurat <- RunPCA(my_seurat, features = VariableFeatures(object = my_seurat))
my_seurat <- FindNeighbors(my_seurat, dims = 1:10)
my_seurat <- FindClusters(my_seurat, resolution = 0.5)
my_seurat <- RunUMAP(my_seurat, dims = 1:10)
df <- data.frame(my_seurat@reductions$umap@cell.embeddings, cellTypes499)
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24), legend.position = "none") + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Simulated Data: 0x Contamination")
save(df, file = "~/simulambient/Data/seed615_groundtruth.RData")
my_seurat <- CreateSeuratObject(negBinTrial$`1`)
my_seurat <- NormalizeData(my_seurat)
my_seurat <- FindVariableFeatures(my_seurat, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(my_seurat)
my_seurat <- ScaleData(my_seurat, features = all.genes)
my_seurat <- RunPCA(my_seurat, features = VariableFeatures(object = my_seurat))
my_seurat <- FindNeighbors(my_seurat, dims = 1:10)
my_seurat <- FindClusters(my_seurat, resolution = 0.5)
my_seurat <- RunUMAP(my_seurat, dims = 1:10)
df <- data.frame(my_seurat@reductions$umap@cell.embeddings, cellTypes499)
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24), legend.position = "none") + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Simulated Data: 1x Contamination")
my_seurat <- CreateSeuratObject(negBinTrial$`2`)
my_seurat <- NormalizeData(my_seurat)
my_seurat <- FindVariableFeatures(my_seurat, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(my_seurat)
my_seurat <- ScaleData(my_seurat, features = all.genes)
my_seurat <- RunPCA(my_seurat, features = VariableFeatures(object = my_seurat))
my_seurat <- FindNeighbors(my_seurat, dims = 1:10)
my_seurat <- FindClusters(my_seurat, resolution = 0.5)
my_seurat <- RunUMAP(my_seurat, dims = 1:10)
save(df, file = "~/simulambient/Data/seed615_contam1.RData")
df <- data.frame(my_seurat@reductions$umap@cell.embeddings, cellTypes499)
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24), legend.position = "none") + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Simulated Data: 2x Contamination")
save(df, file = "~/simulambient/Data/seed615_contam2.RData")
my_seurat <- CreateSeuratObject(negBinTrial$`5`)
my_seurat <- NormalizeData(my_seurat)
my_seurat <- FindVariableFeatures(my_seurat, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(my_seurat)
my_seurat <- ScaleData(my_seurat, features = all.genes)
my_seurat <- RunPCA(my_seurat, features = VariableFeatures(object = my_seurat))
my_seurat <- FindNeighbors(my_seurat, dims = 1:10)
my_seurat <- FindClusters(my_seurat, resolution = 0.5)
my_seurat <- RunUMAP(my_seurat, dims = 1:10)
df <- data.frame(my_seurat@reductions$umap@cell.embeddings, cellTypes499)
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24), legend.position = "none") + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Simulated Data: 2x Contamination")
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24), legend.position = "none") + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Simulated Data: 5x Contamination")
rnrn <- rmultinom(1, 100.545, counts499[,1])
View(rnrn)
sum(rnrn)
save(df, file = "~/simulambient/Data/seed615_contam5.RData")
rm(attempt2, my_seurat, dd, df, negBinTrial, rnrn, all.genes)
gc()
devtools::install_github("michael-sweeney/simulambient")
devtools::install_github("michael-sweeney/simulambient")
?install_github
devtools::document()
devtools::install_github("michael-sweeney/simulambient")
devtools::install_github("michael-sweeney/simulambient")
devtools::document()
library(simulambient)
library(simulambient)
warnings()
load("~/simulambient/Data/negBinTrial_Dec14.RData")
my_seurat <- CreateSeuratObject(negBinTrial2$ground_truth)
my_seurat <- NormalizeData(my_seurat)
my_seurat <- FindVariableFeatures(my_seurat, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(my_seurat)
my_seurat <- ScaleData(my_seurat, features = all.genes)
my_seurat <- RunPCA(my_seurat, features = VariableFeatures(object = my_seurat))
my_seurat <- FindNeighbors(my_seurat, dims = 1:10)
my_seurat <- FindClusters(my_seurat, resolution = 0.5)
my_seurat <- RunUMAP(my_seurat, dims = 1:10)
df <- data.frame(my_seurat@reductions$umap@cell.embeddings, cellTypes499)
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24), legend.position = "none") + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Simulated Data: 0x Contamination")
save(df, file = "~/simulambient/Data/seed2022_groundtruth.RData")
my_seurat <- CreateSeuratObject(negBinTrial2$`1`)
my_seurat <- NormalizeData(my_seurat)
my_seurat <- FindVariableFeatures(my_seurat, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(my_seurat)
my_seurat <- ScaleData(my_seurat, features = all.genes)
my_seurat <- RunPCA(my_seurat, features = VariableFeatures(object = my_seurat))
my_seurat <- FindNeighbors(my_seurat, dims = 1:10)
my_seurat <- FindClusters(my_seurat, resolution = 0.5)
my_seurat <- RunUMAP(my_seurat, dims = 1:10)
df <- data.frame(my_seurat@reductions$umap@cell.embeddings, cellTypes499)
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24), legend.position = "none") + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Simulated Data: 1x Contamination")
save(df, file = "~/simulambient/Data/seed2022_contam1.RData")
my_seurat <- CreateSeuratObject(negBinTrial2$`2`)
my_seurat <- NormalizeData(my_seurat)
my_seurat <- FindVariableFeatures(my_seurat, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(my_seurat)
my_seurat <- ScaleData(my_seurat, features = all.genes)
my_seurat <- RunPCA(my_seurat, features = VariableFeatures(object = my_seurat))
my_seurat <- FindNeighbors(my_seurat, dims = 1:10)
my_seurat <- FindClusters(my_seurat, resolution = 0.5)
my_seurat <- RunUMAP(my_seurat, dims = 1:10)
df <- data.frame(my_seurat@reductions$umap@cell.embeddings, cellTypes499)
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24), legend.position = "none") + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Simulated Data: 2x Contamination")
save(df, file = "~/simulambient/Data/seed2022_contam2.RData")
my_seurat <- CreateSeuratObject(negBinTrial2$`5`)
my_seurat <- NormalizeData(my_seurat)
my_seurat <- FindVariableFeatures(my_seurat, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(my_seurat)
my_seurat <- ScaleData(my_seurat, features = all.genes)
my_seurat <- RunPCA(my_seurat, features = VariableFeatures(object = my_seurat))
my_seurat <- FindNeighbors(my_seurat, dims = 1:10)
my_seurat <- FindClusters(my_seurat, resolution = 0.5)
my_seurat <- RunUMAP(my_seurat, dims = 1:10)
df <- data.frame(my_seurat@reductions$umap@cell.embeddings, cellTypes499)
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24), legend.position = "none") + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Simulated Data: 5x Contamination")
save(df, file = "~/simulambient/Data/seed2022_contam5.RData")
load("~/simulambient/Data/negBinTrial_Dec14_2.RData")
my_seurat <- CreateSeuratObject(negBinTrial3$ground_truth)
my_seurat <- NormalizeData(my_seurat)
my_seurat <- FindVariableFeatures(my_seurat, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(my_seurat)
my_seurat <- ScaleData(my_seurat, features = all.genes)
my_seurat <- RunPCA(my_seurat, features = VariableFeatures(object = my_seurat))
my_seurat <- FindNeighbors(my_seurat, dims = 1:10)
my_seurat <- FindClusters(my_seurat, resolution = 0.5)
my_seurat <- RunUMAP(my_seurat, dims = 1:10)
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24), legend.position = "none") + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Simulated Data: 0x Contamination")
df <- data.frame(my_seurat@reductions$umap@cell.embeddings, cellTypes499)
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24), legend.position = "none") + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Simulated Data: 0x Contamination")
save(df, file = "~/simulambient/Data/seed12_groundtruth.RData")
my_seurat <- CreateSeuratObject(negBinTrial3$`1`)
my_seurat <- NormalizeData(my_seurat)
my_seurat <- FindVariableFeatures(my_seurat, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(my_seurat)
my_seurat <- ScaleData(my_seurat, features = all.genes)
my_seurat <- RunPCA(my_seurat, features = VariableFeatures(object = my_seurat))
my_seurat <- FindNeighbors(my_seurat, dims = 1:10)
my_seurat <- FindClusters(my_seurat, resolution = 0.5)
my_seurat <- RunUMAP(my_seurat, dims = 1:10)
df <- data.frame(my_seurat@reductions$umap@cell.embeddings, cellTypes499)
save(df, file = "~/simulambient/Data/seed12_contam1.RData")
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24), legend.position = "none") + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Simulated Data: 1x Contamination")
my_seurat <- CreateSeuratObject(negBinTrial3$`2`)
my_seurat <- NormalizeData(my_seurat)
my_seurat <- FindVariableFeatures(my_seurat, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(my_seurat)
my_seurat <- ScaleData(my_seurat, features = all.genes)
my_seurat <- RunPCA(my_seurat, features = VariableFeatures(object = my_seurat))
my_seurat <- FindNeighbors(my_seurat, dims = 1:10)
my_seurat <- FindClusters(my_seurat, resolution = 0.5)
my_seurat <- RunUMAP(my_seurat, dims = 1:10)
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24), legend.position = "none") + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Simulated Data: 2x Contamination")
df <- data.frame(my_seurat@reductions$umap@cell.embeddings, cellTypes499)
save(df, file = "~/simulambient/Data/seed12_contam2.RData")
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24), legend.position = "none") + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Simulated Data: 2x Contamination")
my_seurat <- CreateSeuratObject(negBinTrial3$`5`)
my_seurat <- NormalizeData(my_seurat)
my_seurat <- FindVariableFeatures(my_seurat, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(my_seurat)
my_seurat <- ScaleData(my_seurat, features = all.genes)
my_seurat <- RunPCA(my_seurat, features = VariableFeatures(object = my_seurat))
my_seurat <- FindNeighbors(my_seurat, dims = 1:10)
my_seurat <- FindClusters(my_seurat, resolution = 0.5)
my_seurat <- RunUMAP(my_seurat, dims = 1:10)
df <- data.frame(my_seurat@reductions$umap@cell.embeddings, cellTypes499)
save(df, file = "~/simulambient/Data/seed12_contam5.RData")
ggplot(df, aes(x = UMAP_1, y = UMAP_2, color = cellTypes499)) + geom_point() + theme_classic() + theme(title = element_text(size = 18), text = element_text(size = 18), plot.title = element_text(hjust = 0.5, face = "bold", size = 24), legend.position = "none") + scale_color_manual(values = c("Type_1" = "firebrick1", "Type_2a" = "darkorchid", "Type_2x" = "dodgerblue", "Macrophage" = "gold", "Muscle_Fiber_Mixed" = "lawngreen", "Endothelial" = "darkgreen", "Mesenchymal_Stem_Cell" = "maroon1", "Satellite_Cell" = "cyan", "Neuromuscular_junction" = "saddlebrown", "Smooth_Muscle" = "lightpink","Neuronal" = "wheat", "T_Cell" = "gray75", "Adipocyte" = "black"), name = "Cell Types") + ggtitle("Simulated Data: 5x Contamination")
rm(my_seurat)
gc()
c <- rep(1, 20)
d <- 1:20
?rmultinom
dd <- decontaminate(counts499, contamination = ambient[,1:60000], cellTypes = cellTypes499)
abc <- data.frame((colSums(counts499) - colSums(dd)) / colSums(counts499), cellTypes499)
View(abc)
table(cellTypes499)
colnames(abc) <- c("cont", "cellTypes")
abc[,1] <- abc[,1] * 100
ag <- aggreagate(cont~cellTypes, abc, FUN = mean)
ag <- aggregate(cont~cellTypes, abc, FUN = mean)
View(ag)
View(ag)
mean(ag$cont)
mean(abc$cont)
devtools::document()
warnings()
library(simulambient)
devtools::install_github("michael-sweeney/simulambient")
devtools::install_github("michael-sweeney/simulambient")
